<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.choi.calender.mapper.CalenderMapper">
    <!-- TypeHandler 등록 -->
<!--    <typeHandlers>-->
<!--        <typeHandler handler="com.choi.calender.application.handler.ListToStringTypeHandler" />-->
<!--    </typeHandlers>-->

    <insert id="insertDiary" parameterType="diaryBean">
        INSERT INTO tb_diary
        (
            dairy_date,
            day_of_week,
            weather,
            emotion,
            content
        )
        VALUES
        (
            #{date},
            #{dayOfWeek},
            #{weather},
            #{emotion},
            #{content}
        )
    </insert>

    <insert id="insertTarget" parameterType="targetBean">
        INSERT INTO tb_target
        (
            title,
            type,
            <if test="month != null and month != ''">
                month,
            </if>
            <if test="time != null and time != ''">
                time,
            </if>
            <if test="repeatYn != null and repeatYn != ''">
                repeat_yn,
            </if>
            <if test="successYn != null and successYn != ''">
                success_yn,
            </if>
            year
        )
        VALUES
        (
            #{title},
            #{type},
            <if test="month != null and month != ''">
                #{month},
            </if>
            <if test="time != null and time != ''">
                #{time},
            </if>
            <if test="repeatYn != null and repeatYn != ''">
                #{repeatYn},
            </if>
            <if test="successYn != null and successYn != ''">
                #{successYn},
            </if>
            #{year}
        )
    </insert>






    <select id="isDuplicationIdCheck" parameterType="String" resultType="boolean">
        SELECT
            IF(COUNT(1) >= 1, TRUE, FALSE) as dupli
        FROM
            tb_user
        <where>
            AND id = #{id}
        </where>
    </select>

    <update id="updateApproveStatus" parameterType="string">
        UPDATE tb_user
        SET approve_yn = #{status}
        WHERE id = #{id}
    </update>

    <update id="updateUserData" parameterType="diaryBean">
        UPDATE tb_user
        SET
            pw = #{pw},
            name = #{name},
            email = #{email},
            phone = #{phone},
            company_name = #{companyName},
            position = #{position},
            etc = #{etc}
        WHERE id = #{id}
    </update>
</mapper>
